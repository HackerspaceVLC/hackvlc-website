{{ define "main" }}

<section class="hero">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6">
        <div class="terminal-window mb-4">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">root@hackerspace:~#</div>
          </div>
          <div class="terminal-body p-3">
            <div class="output">
              <span class="prompt">$</span> <span class="command">whoami</span><br>
              <span class="success">{{ .Site.Title }}</span><br>
              <span class="prompt">$</span> <span class="command">cat description.txt</span><br>
              <span class="output">{{ .Site.Params.description }}</span>
            </div>
          </div>
        </div>
        <div class="hero-buttons has-animation">
          <a href="{{ .Site.Params.primaryButtonURL | default "/#about" | relLangURL }}" class="btn">
          $ ./join_community.sh
          </a>
          <a href="{{ .Site.Params.secondaryButtonURL | default "/proyectos/" | relLangURL }}" class="btn">
          $ ls projects/
          </a>
        </div>
      </div>
      <div class="col-lg-6 mt-5 mt-lg-0">
        {{ if .Site.Params.heroImage }}
        <div class="terminal-window">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">preview.sh</div>
          </div>
          <div class="terminal-body p-0">
            <img src="{{ .Site.Params.heroImage | relURL }}" alt="{{ .Site.Title }}" class="img-fluid" style="border-radius: 0;">
          </div>
        </div>
        {{ end }}
      </div>
    </div>
  </div>
</section>

<section id="about" class="about-section py-5">
  <div class="container text-center">
    <div class="section-header has-animation">
      {{ i18n "aboutUs" }}
    </div>

    <div class="row g-4">
      <div class="col-md-4">
        <div class="terminal-window has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">community.sh</div>
          </div>
          <div class="terminal-body p-3">
            <div class="output">
              <span class="prompt">$</span> <span class="command">cat community.txt</span><br>
              <span class="success">{{ i18n "learningCommunity" }}</span><br>
              <span class="output">{{ i18n "learningCommunityDesc" }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="terminal-window has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">opensource.sh</div>
          </div>
          <div class="terminal-body p-3">
            <div class="output">
              <span class="prompt">$</span> <span class="command">apt-get install freedom</span><br>
              <span class="success">{{ i18n "openSource" }}</span><br>
              <span class="output">{{ i18n "openSourceDesc" }}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="terminal-window has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">creativity.sh</div>
          </div>
          <div class="terminal-body p-3">
            <div class="output">
              <span class="prompt">$</span> <span class="command">chmod +x creativity</span><br>
              <span class="success">{{ i18n "creativeHackers" }}</span><br>
              <span class="output">{{ i18n "creativeHackersDesc" }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{{ $serviceData := index .Site.Data .Site.Language.Lang "service" }}
{{ if $serviceData }}
<section id="activities" class="activities-section py-5">
  <div class="container text-center">
    <div class="section-header has-animation">
      {{ $serviceData.service.title }}
    </div>

    <div class="row g-4">
      {{ range $serviceData.service.service_item }}
      <div class="col-lg-4 col-md-6">
        <div class="service-card has-animation">
          <div class="service-icon">
            <i class="{{ .icon }}"></i>
          </div>
          <h3>{{ .name }}</h3>
          <p>{{ .content }}</p>
        </div>
      </div>
      {{ end }}
    </div>
  </div>
</section>
{{ end }}

{{ if .Site.Data.projects }}
<section id="portfolio" class="projects-section py-5">
  <div class="container text-center">
    <div class="section-header has-animation">
      {{ i18n "projects" }}
    </div>

    <div class="row g-4">
      {{ range first 6 .Site.Data.projects }}
      <div class="col-lg-4 col-md-6">
        <div class="terminal-window project-card has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">{{ .title }}</div>
          </div>
          <div class="terminal-body p-0">
            {{ if .image }}
            <img src="{{ .image | relURL }}" class="card-img-top" alt="{{ .title }}" style="border-radius: 0;">
            {{ end }}
            <div class="p-3">
              <div class="output">
                <span class="prompt">$</span> <span class="command">cat README.md</span><br>
                <span class="output">{{ .description }}</span>
              </div>
              {{ if .link }}
              <div class="mt-3">
                <a href="{{ .link | relLangURL }}" class="btn btn-sm">$ ./run.sh</a>
              </div>
              {{ end }}
            </div>
          </div>
        </div>
      </div>
      {{ end }}
    </div>

    <div class="text-center mt-5">
      <a href="{{ "proyectos" | relLangURL }}" class="btn">$ ls -la projects/</a>
    </div>
  </div>
</section>
{{ end }}

<!-- Recently Finished Projects Section -->
<section id="recent-projects" class="py-5">
  <div class="container">
    <div class="section-header has-animation text-center mb-5">
      > ls projects/ --filter=documented
    </div>

    <div class="row g-4">
      <!-- RetroBooth -->
      <div class="col-lg-4 col-md-6">
        <div class="terminal-window project-card has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">RetroBooth</div>
          </div>
          <div class="terminal-body p-0">
            <img src="images/portfolio/retrobooth.webp" class="card-img-top" alt="RetroBooth" style="border-radius: 0;">
            <div class="p-3">
              <div class="output">
                <span class="prompt">$</span> <span class="command">cat status.txt</span><br>
                <span class="success">✓ En Progreso</span><br>
                <span class="output">Fotomatón retro con selección de filtros NFC</span>
              </div>
              <div class="mt-3">
                <a href="{{ "proyectos/retrobooth" | relLangURL }}" class="btn btn-sm">$ ./view_project.sh</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Robot Destructor -->
      <div class="col-lg-4 col-md-6">
        <div class="terminal-window project-card has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">Robot Destructor</div>
          </div>
          <div class="terminal-body p-0">
            <img src="images/portfolio/destructor.webp" class="card-img-top" alt="Robot Destructor" style="border-radius: 0;">
            <div class="p-3">
              <div class="output">
                <span class="prompt">$</span> <span class="command">cat status.txt</span><br>
                <span class="success">✓ Completado</span><br>
                <span class="output">Vehículo robótico con capacidades de destrucción</span>
              </div>
              <div class="mt-3">
                <a href="{{ "proyectos/robot-destructor" | relLangURL }}" class="btn btn-sm">$ ./view_project.sh</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Máquina Arcade -->
      <div class="col-lg-4 col-md-6">
        <div class="terminal-window project-card has-animation">
          <div class="terminal-header">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">Máquina Arcade</div>
          </div>
          <div class="terminal-body p-0">
            <img src="images/portfolio/arcade.webp" class="card-img-top" alt="Máquina Arcade" style="border-radius: 0;">
            <div class="p-3">
              <div class="output">
                <span class="prompt">$</span> <span class="command">cat status.txt</span><br>
                <span class="success">✓ Completado</span><br>
                <span class="output">Máquina arcade completa construida con Raspberry Pi 3B+</span>
              </div>
              <div class="mt-3">
                <a href="{{ "proyectos/arcade" | relLangURL }}" class="btn btn-sm">$ ./view_project.sh</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-5">
      <a href="{{ "proyectos" | relLangURL }}" class="btn">$ ls -la projects/</a>
    </div>
  </div>
</section>

<!-- Projects That Need Help Section -->
{{ $helpProjects := where (where site.RegularPages "Section" "proyectos") "Params.needs_help" true }}
{{ if $helpProjects }}
<section id="help-projects" class="py-5 bg-dark">
  <div class="container">
    <div class="section-header has-animation text-center mb-5">
      > ls projects/ --filter=needs_help
    </div>

    <div class="row g-4">
      {{ range first 3 $helpProjects }}
      <div class="col-lg-4 col-md-6">
        <div class="terminal-window project-card has-animation border-warning">
          <div class="terminal-header bg-warning">
            <div class="terminal-dots">
              <span class="terminal-dot red"></span>
              <span class="terminal-dot yellow"></span>
              <span class="terminal-dot green"></span>
            </div>
            <div class="terminal-title">{{ .Title }} - NEEDS HELP</div>
          </div>
          <div class="terminal-body p-0">
            {{ if .Params.image }}
            <img src="{{ .Params.image | relURL }}" class="card-img-top" alt="{{ .Title }}" style="border-radius: 0;">
            {{ end }}
            <div class="p-3">
              <div class="output">
                <span class="prompt">$</span> <span class="command">cat help_request.txt</span><br>
                <span class="warning">⚠ Help Needed</span><br>
                <span class="output">{{ .Params.help_description | default "This project needs your help!" }}</span>
              </div>
              <div class="mt-3">
                <a href="{{ .Permalink }}" class="btn btn-sm btn-warning">$ ./help_project.sh</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      {{ end }}
    </div>

    <div class="text-center mt-5">
      <a href="{{ "proyectos" | relLangURL }}" class="btn btn-warning">$ git checkout --help-needed</a>
    </div>
  </div>
</section>
{{ end }}

<!-- Pricing Section -->
<section id="pricing" class="py-5">
  <div class="container text-center">
    <div class="section-header has-animation">
      {{ i18n "monthlyFee" }}
    </div>

    <div class="row justify-content-center">
      <!-- Cuota Reducida -->
      <div class="col-lg-5 col-md-6 mb-4 mb-md-0">
        <div class="pricing-card has-animation">
          <h3>{{ i18n "reducedFee" }}</h3>
          <p class="text-muted">{{ i18n "reducedFeeExplanation" }}</p>
          <div class="pricing-value">
            <span>10€</span>
            <span>/ {{ i18n "month" }}</span>
          </div>
          <ul>
            <li>{{ i18n "accessToWorkshopTools" }}</li>
            <li>{{ i18n "activeMakerCommunity" }}</li>
            <li>{{ i18n "communicationGroups" }}</li>
            <li>{{ i18n "workshopsAndEvents" }}</li>
          </ul>
          <a href="{{ "pages/alta" | relLangURL }}" class="btn">
          $ ./join_reduced.sh
          </a>
        </div>
      </div>

      <!-- Cuota General -->
      <div class="col-lg-5 col-md-6">
        <div class="pricing-card has-animation">
          <h3>{{ i18n "generalFee" }}</h3>
          <p class="text-muted">{{ i18n "generalFeeExplanation" }}</p>
          <div class="pricing-value">
            <span>25€</span>
            <span>/ {{ i18n "month" }}</span>
          </div>
          <ul>
            <li>{{ i18n "accessToWorkshopTools" }}</li>
            <li>{{ i18n "activeMakerCommunity" }}</li>
            <li>{{ i18n "communicationGroups" }}</li>
            <li>{{ i18n "workshopsAndEvents" }}</li>
          </ul>
          <a href="{{ "pages/alta" | relLangURL }}" class="btn">
          $ ./join_general.sh
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Contact Section -->
<section id="contact" class="py-5">
  <div class="container text-center">
    <div class="section-header has-animation">
      {{ i18n "contact" }}
    </div>

    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card has-animation">
          <div class="card-body py-5">
            <div class="row">
              <div class="col-md-6 mb-4 mb-md-0">
                <div class="contact-info">
                  <i class="fa-solid fa-location-dot mb-3 fs-3 text-primary"></i>
                  <h5>{{ i18n "location" }}</h5>
                  <p>{{ $.Site.Params.location | safeHTML }}</p>
                </div>
              </div>
              <div class="col-md-6">
                <div class="contact-info">
                  <i class="fa-solid fa-envelope mb-3 fs-3 text-primary"></i>
                  <h5>{{ i18n "email" }}</h5>
                  <p><a href="mailto:{{ $.Site.Params.email }}">{{ $.Site.Params.email }}</a></p>
                </div>
              </div>
            </div>
            <div class="mt-4">
              <div id="contact-map" class="mt-4 rounded" style="height: 300px; width: 100%;"></div>

              <!-- Cargar Leaflet CSS y JS manualmente aquí para asegurar que estén disponibles -->
              <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
              <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

              <script>
                document.addEventListener('DOMContentLoaded', function() {
                  // Esperar un momento para asegurarnos que Leaflet está cargado completamente
                  setTimeout(function() {
                    if (typeof L !== 'undefined') {
                      // Coordenadas del Hackerspace Valencia
                      var lat = {{ $.Site.Params.mapLatitude | default "39.488339464485364" }};
                      var lng = {{ $.Site.Params.mapLongitude | default "-0.35849245006843755" }};

                      // Inicializa el mapa
                      var map = L.map('contact-map').setView([lat, lng], 16);

                      // Añade el layer de OpenStreetMap
                      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                      }).addTo(map);

                      // Añade un marcador en la ubicación del Hackerspace
                      var marker = L.marker([lat, lng]).addTo(map);
                      marker.bindPopup("<b>Hackerspace Valencia</b><br>{{ $.Site.Params.location | safeHTML }}").openPopup();
                    } else {
                      console.error("Leaflet (L) no está disponible después de cargar");
                      document.getElementById('contact-map').innerHTML = "<p>No se pudo cargar el mapa. Por favor, recarga la página.</p>";
                    }
                  }, 500); // Esperar 500ms para asegurarse que todo está cargado
                });
              </script>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

{{ end }}